import{a as n}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-74HS5GPD.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-6KSQTR3K.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-EY3A6WHN.js";import{a as m,b as w}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-Z3IWNWTW.js";import{c as p,d as b}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-SZANIQQV.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-LRRFCMXM.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-GM7XC6J3.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-QIL3CJLY.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-Y6PMXGG5.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-O57S3OAW.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-K3ZYVFBP.js";import{o as f}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-JM53CC5U.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-2WCAUBI2.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-JDTPYEAT.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-MFXGAUC4.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-LWRNICVK.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-4O2Y2YMJ.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-AYKRG7IZ.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-HMT5347T.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-LSFWVCTE.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-XGUF5G5P.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-K6CGFI43.js";import{q as l,r as y}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-GJMZ6BWS.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-57NWEFIT.js";import{a as v}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-3ACY4EGJ.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-M3SREHKX.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-2Q6N434I.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-57ONJ7QI.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-77QY5NMS.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-BWADEWRI.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-KUOFTD55.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-XDPBTDM5.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-LEEERCP7.js";import{k as S}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-5KFVCKRO.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-IX3NABCQ.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-NAPGXKG3.js";import{D as c,F as u}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-5L33RLEK.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-33Q5QQWW.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-3ZGZD3KQ.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-CX3JD5K2.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-WYEG4Q4X.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-JBYZM3ZN.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-LNLS45XN.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-ALEAORJC.js";import"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-QRMZIDGZ.js";import{d as h,f as s}from"https://st-p.rmcdn1.net/8b076c5f/dist/c/c-B5ZKAV4B.js";w();var g=h(S()),a=h(v());b();y();f();u();var d=class extends n{constructor(t,e,o){super(t,e,o);s(this,"sharedState");s(this,"autoplay");s(this,"unsubscribeReady");s(this,"triggerWidgets",[]);s(this,"handleClick",function(){++this.sharedState.clickCount}.bind(this));s(this,"handlePointerHover",function(e){this.sharedState.isPointerIn=e.type==="mouseenter"}.bind(this));s(this,"handlePointerState",function(e){e.preventDefault(),this.sharedState.isPointerIn=e.type==="pointerdown"}.bind(this));s(this,"handleTouchSideEffects",function(e){e.preventDefault()}.bind(this));s(this,"player",{play:function(){this.sharedState.player.play()}.bind(this),pause:function(){this.sharedState.player.stop()}.bind(this)});return this.model=new a.default.Model(t),this.sharedState=new p(this.model.attributes),this.sharedState.renderSimpleVersion=!!window.RM.screenshot,this.sharedState.controlsCursorStyle=e.mag.hoverCursorStyle,n.prototype.initialize.apply(this,[t,e,o]),this}async render(){(this.model.attributes.provider_name||"").toLowerCase()==="vimeo"&&m.brokenVimeoThumbnailRegexp.test(this.model.get("thumbnail_url"))&&this.model.unset("thumbnail_url"),this.makeBox("video"),this.$el.addClass("no-transparency");let{renderReact:t}=await import("https://st-p.rmcdn1.net/8b076c5f/dist/c/c-5GVPEKL4.js"),{VideoPlayerViewerOld:e}=await import("https://st-p.rmcdn1.net/8b076c5f/dist/c/c-IS3QSOYM.js");return t({component:()=>c(e,{sharedState:this.sharedState,analytics:window.RM.analytics}),domElement:this.el,model:this.model,onDestroy:()=>{let i=this.el;g.default.unmountComponentAtNode(i),i&&i.parentNode&&i.parentNode.removeChild(i)}}),this.unsubscribeReady=this.sharedState.subscribe("isReady",i=>{i&&(this.widgetIsLoaded(),this.unsubscribeReady?.())}),this.checkLink(),this.rendered=!0,this.trigger("rendered"),this}isValid(){return!!(this.model.attributes.url&&this.model.attributes.provider_name)}start(){return n.prototype.start.call(this),window.RM.screenshot||this.destroyed?this:(this.bindTriggers(),this.sharedState.isStarted=!0,this)}stop(){return n.prototype.stop.call(this),!window.RM.screenshot&&!this.destroyed&&this.sharedState.player&&this.rendered&&this.sharedState.player.stop(),this.unbindTriggers(),this}_needAutoStart(){return this.autoplay&&!l.PageVisibilityManager.isPageHidden()}getPageScale(){return this.page.mag.getScale(this.page.viewport)}async bindTriggers(){let t=this.model.attributes.triggers?.length?this.model.attributes.triggers:[this.model.attributes._id];for(let e of t){let o=await this.page.mag.getAllWidgetViewsByIdAsync(e,this.page);for(let i of o){let r=i.el;if(r instanceof HTMLElement){switch(this.model.attributes.custom_controls?.playbackType){case"Click":r.addEventListener("click",this.handleClick);break;case"Hover":r.addEventListener("mouseenter",this.handlePointerHover),r.addEventListener("mouseleave",this.handlePointerHover),"ontouchstart"in window&&(r.addEventListener("pointerdown",this.handlePointerState),r.addEventListener("pointerup",this.handlePointerState),r.addEventListener("pointerleave",this.handlePointerState)),r.addEventListener("touchstart",this.handleTouchSideEffects),r.addEventListener("contextmenu",this.handleTouchSideEffects);break}this.triggerWidgets.push(i)}}}}unbindTriggers(){for(let t of this.triggerWidgets){let e=t.el;e instanceof HTMLElement&&(e.removeEventListener("click",this.handleClick),e.removeEventListener("mouseenter",this.handlePointerHover),e.removeEventListener("mouseleave",this.handlePointerHover),e.removeEventListener("pointerdown",this.handlePointerState),e.removeEventListener("pointerup",this.handlePointerState),e.removeEventListener("pointerleave",this.handlePointerState),e.removeEventListener("touchstart",this.handleTouchSideEffects),e.removeEventListener("contextmenu",this.handleTouchSideEffects))}}destroy(...t){this.sharedState.player?.stop(),this.unsubscribeReady?.(),n.prototype.destroy.apply(this,t)}updateVideoWidget(t){this.unbindTriggers(),this.model=new a.default.Model(t),this.sharedState.widget=t,this.sharedState.pageScale=this.getPageScale(),this.bindTriggers()}},H=d;export{H as default};
